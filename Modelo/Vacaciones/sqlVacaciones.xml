<root>
    <VISUALIZAR_EMPLEADOS>
        <sql>
            SELECT
            EMPL.EMPL_ID AS EMPLEADO_ID,
            TPD.TIP_DESCRIPCION AS TIPO_DOCUMENTO,
            EMPL.NUM_DOCUMENTO AS NUMDOCUMENTO,
            CC.CDC_DESCRIPCION AS TIPO_CONTRATACION,
            CONCAT(EMPL.EMPL_PRIMER_NOMBRE,' ',EMPL.EMPLE_SEGUNDO_NOMBRE,' ',EMPL.EMPL_PRIMER_APELLIDO,' ',EMPL.EMPL_SEGUNDO_APELLIDO) AS NOMBRE_COMPLETO,
            ATR.ADT_DESCRIPCION AS AREA,
            CARG.CRG_DESCRIPCION AS CARGO,
            DATE(VACD.FECHA_PV_INICIO_VAC) AS PER_VENC_INICIO,
	        DATE(VACD.FECHA_PV_FIN_VAC )AS PER_VENC_FIN,
	        DATE(VACD.FECHA_INICIO_VAC) AS INICIO_VACACIONES,
	        DATE(VACD.FECHA_FIN_VAC) AS FIN_VACACIONES,
            EMPL.EMPL_ESTADO AS ID_EMPL_ESTADO,
            VAC.VAC_ID AS VAC_ID
            FROM
            EMPLEADOS EMPL
            INNER JOIN TIPO_DOCUMENTO TPD ON TPD.TIP_ID = EMPL.TIP_ID
            LEFT JOIN CONTRATO CTR ON CTR.EMPL_ID = EMPL.EMPL_ID
            LEFT JOIN CENTRO_DE_COSTO CC ON CC.CDC_ID = CTR.CTDC_ID
            LEFT JOIN AREA_TRABAJO ATR ON ATR.ADT_ID = CTR.ADT_ID
            LEFT JOIN VACACIONES VAC  ON VAC.EMPL_ID = EMPL.EMPL_ID
            LEFT JOIN VACACIONES_DETALLE VACD ON VACD.VAC_ID = VAC.VAC_ID
            LEFT JOIN CARGOS CARG ON CARG.CRG_ID = CTR.CRG_ID
            GROUP BY EMPL.EMPL_ID
        </sql>
    </VISUALIZAR_EMPLEADOS>
    <REGISTRAR_VACACIONES>
        <sql>
            INSERT INTO VACACIONES (EMPL_ID) VALUES (?);
        </sql>
    </REGISTRAR_VACACIONES>
    <VACACIONES_DETALLE>
        <sql>
            INSERT INTO VACACIONES_DETALLE(VAC_ID,FECHA_PV_INICIO_VAC,FECHA_PV_FIN_VAC,FECHA_INICIO_VAC,FECHA_FIN_VAC,VACD_OBSERVACIONES)VALUES(?,?,?,?,?,?);
        </sql>
    </VACACIONES_DETALLE>
    <OBTENER_HISTORIAL>
        <sql>
            SELECT
            VAC.VAC_ID AS ID_VAC,
            VACD.VACD_ID AS ID_VACD,
            VAC.EMPL_ID AS ID_EMPL,
            DATE(VACD.FECHA_PV_INICIO_VAC) AS PERIODO_VENCIDO_DESDE,
            DATE(VACD.FECHA_PV_FIN_VAC) AS PERIODO_VENCIDO_HASTA,
            DATE(VACD.FECHA_INICIO_VAC) AS FECHA_INICIO_VACACIONES,
            DATE(VACD.FECHA_FIN_VAC) AS FECHA_FIN_VACACIONES,
            VACD.VACD_OBSERVACIONES AS OBSERVACIONES,
            VACD.VACD_ESTADO AS VACD_ESTADO 
            FROM
            VACACIONES VAC
            INNER JOIN VACACIONES_DETALLE VACD ON VACD.VAC_ID = VAC.VAC_ID
            WHERE VAC.VAC_ID = ?;
        </sql>
    </OBTENER_HISTORIAL>
    <ACTUALIZAR_DATOS>
        <sql>
            UPDATE VACACIONES_DETALLE
            SET FECHA_PV_INICIO_VAC = ?,
            FECHA_PV_FIN_VAC = ?,
            FECHA_INICIO_VAC = ?,
            FECHA_FIN_VAC = ?,
            VACD_OBSERVACIONES = ?,
            VACD_ESTADO = ?
            WHERE VACD_ID = ?
        </sql>
    </ACTUALIZAR_DATOS>
</root>