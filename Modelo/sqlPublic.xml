<root>
    <LOGUEAR_USUARIO>
        <sql>
            SELECT UPPER(USU_USUARIO) AS USU_USUARIO,PER_ID , USU.USU_ID, USU.USU_DOCUMENTO, CONCAT(USU_PRIMER_NOMBRE,  ' ', COALESCE(USU_SEGUNDO_NOMBRE,''), ' ', USU_PRIMER_APELLIDO, ' ', COALESCE(USU_SEGUNDO_APELLIDO,'')) AS NOMBRE /*,TER.TER_ID,
            EMP.EMP_TITULO_REPORTE AS NOMBRE_EMPRESA,EMP.RUTA_LOG AS LOGO,EMP.EMP_BD AS BD*/
            FROM CONFIGURACIONESNOM.USUARIO USU 
            /*INNER JOIN TERCEROS TER ON  USU.USU_DOCUMENTO = TER.TER_DOCUMENTO*/
            WHERE USU.USU_ESTADO = 'A' AND USU.USU_USUARIO = ? AND USU.USU_CONTRASENA =?;
        </sql>
    </LOGUEAR_USUARIO>
    <OBTENER_EMPRESA_USUARIOS>
     <sql>
            SELECT EMP.EMP_ID AS ID_EMPRESA,EMP.EMP_TITULO_REPORTE AS NOMBRE_EMPRESA,EMP.RUTA_LOG AS LOGO,EMP.EMP_BD AS BD
            FROM  EMPRESA EMP 
            INNER JOIN USUARIO_EMPRESAS UE ON UE.EMP_ID = EMP.EMP_ID
            INNER JOIN CONFIGURACIONESNOM.USUARIO USU ON USU.USU_ID = UE.USU_ID
            WHERE USU.USU_ID = ? AND UE.USEM_ESTADO ='A' ;
     </sql>
    </OBTENER_EMPRESA_USUARIOS>
    <CONSULTAR_TERCERO_EMPRESA>
        <sql>
            SELECT TER.TER_ID AS TER_ID ,TER.TER_DOCUMENTO AS DOCUMENTO,NOMBRETERCERO(TER.TER_DOCUMENTO) AS PACIENTE
            FROM  TERCEROS TER 
            INNER JOIN CONFIGURACIONES.USUARIO USU ON USU.USU_DOCUMENTO = TER.TER_DOCUMENTO
            WHERE USU.USU_ID = ? ;
        </sql>
    </CONSULTAR_TERCERO_EMPRESA>
    <VISUALIZAR_MENU_REPORTES>
        <sql>
            SELECT      perfil_menu.men_padre as menu_id, menu.men_nombre  AS pagina_menu,men_icono AS icono_menu  FROM menu menu 
            INNER JOIN perfil_menu perfil_menu  
            ON  menu.men_id   =  perfil_menu.men_padre
            INNER JOIN  usuario usu on perfil_menu.per_id =  usu.per_id
            WHERE usu_id = ?
            AND perfil_menu.per_id = ? and  men_estado =  'A'  and menu.tip_menu =  2
            AND perfil_menu.prm_estado = 'A'
            ORDER BY menu.men_order;
        </sql>
    </VISUALIZAR_MENU_REPORTES>
    <VISUALIZAR_PAGINA_REPORTES>
        <sql>
            SELECT perfil_paginas.pag_id,sof_nombre AS nombre, sof_url as url,sof_icono  as icono ,perfil_paginas.men_id
            FROM  configuracionesnom.perfil_paginas
            INNER JOIN configuracionesnom.paginas USING(pag_id)
            INNER JOIN configuracionesnom.menu men on men.men_id= paginas.men_id
            INNER JOIN configuracionesnom.perfil USING(per_id)
            INNER JOIN configuracionesnom.usuario USING(per_id)
            WHERE  perfil.per_id = ?  AND usuario.usu_id = ?
            AND perfil_paginas.prs_estado = 'A'
            AND men.tip_menu = 2
            ORDER BY 5;
        </sql>
    </VISUALIZAR_PAGINA_REPORTES>
    <LISTAR_COMBO_TIPO_DOCUMENTO>
        <sql>
            SELECT TIP_ID AS ID, TIP_DESCRIPCION AS DESCRIPCION  FROM TIPO_DOCUMENTO;
        </sql>
    </LISTAR_COMBO_TIPO_DOCUMENTO>
    
    <LISTAR_TIPO_PACIENTE>
        <sql>
            SELECT TPC_ID AS  ID, PDC_DESCRIPCION AS DESCRIPCION  FROM  TIPO_PACIENTE;
        </sql>
    </LISTAR_TIPO_PACIENTE>
    
    <LISTAR_COMBO_SEXO>
        <sql>
            SELECT   SEXO.SEX_ID AS ID, SEXO.SEX_DESCRIPCION AS DESCRIPCION FROM SEXO;
        </sql>
    </LISTAR_COMBO_SEXO>
    
    <LISTAR_COMBO_TIPO_MOVIMIENTO>
        <sql>
            SELECT  MOV_ID AS ID , MOV_DESCRIPCION AS DESCRIPCION  FROM MOVIMIENTOS;
        </sql>
    </LISTAR_COMBO_TIPO_MOVIMIENTO>
    
    
    <LISTAR_COMBO_GRUPO_SANGUINEO>
        
        <sql>
            SELECT  GRU_ID  AS ID, GRU_DESCRIPCION AS  DESCRIPCION FROM GRUPO_SANGUINEO;
        </sql>
    </LISTAR_COMBO_GRUPO_SANGUINEO>
    
    
    <LISTAR_COMBO_CIUDADES>
        <sql>
            SELECT CIU_ID  AS  ID, CIU_DESCRIPCION AS DESCRIPCION  FROM CIUDAD;
        </sql>
    </LISTAR_COMBO_CIUDADES>
    
    
    
    <LISTAR_COMBO_OCUPACION>
        <sql>
            SELECT OCUPACION.OCU_ID AS ID, CONCAT(OCU_ID,' | ', OCU_DESCRIPCION)  AS DESCRIPCION FROM  OCUPACION WHERE OCU_ESTADO = 'A';
        </sql>
    </LISTAR_COMBO_OCUPACION>
    
    
    
    
    <LISTAR_COMBO_DEPARTAMENTO>
        <sql>
            SELECT departamento.dep_id AS ID, departamento.dep_descripcion AS  DESCRIPCION  FROM  departamento WHERE dep_id =  (
            SELECT  ciudad.dep_id  FROM  ciudad WHERE ciudad.ciu_id = ?
            );  
        </sql>
    </LISTAR_COMBO_DEPARTAMENTO>
   
  
    
    
    
   
    
    <LISTAR_COMBO_TARIFARIOS>
        <sql>
            SELECT  TAR_ID AS ID, TAR_NOMBRE AS DESCRIPCION  FROM tarifarios WHERE tar_Estado  = 'A';
        </sql>
    </LISTAR_COMBO_TARIFARIOS>
    <LISTAR_COMBO_PROCEDIMIENTO>
        <sql>
            SELECT  ORD_ID  AS ID, ORD_DESCRIPCION AS DESCRIPCION FROM ORDENES_MEDICAS WHERE ORD_ESTADO = 'A' AND ORD_IS_ORDEN;
        </sql>
    </LISTAR_COMBO_PROCEDIMIENTO>
    
    <LISTAR_COMBO_CIVIL>
        <sql>
            SELECT ESTADO_CIVIL.ETC_ID  AS ID, ESTADO_CIVIL.ETC_DESCRIPCION AS DESCRIPCION   FROM  ESTADO_CIVIL;
        </sql>
    </LISTAR_COMBO_CIVIL>
    
    <LISTAR_COMBO_PLANTEL>
        <sql>
            SELECT  TPP_ID AS ID , TPP_NOMBRE AS DESCRIPCION FROM TIPO_PLANTEL;
        </sql>
    </LISTAR_COMBO_PLANTEL>
    
    <LISTAR_COMBO_MOVIL>
        <sql>
            SELECT  AMB_ID AS ID, AMB_DESCRIPCION AS DESCRIPCION  FROM AMBULANCIA;
        </sql>
    </LISTAR_COMBO_MOVIL>
    <LISTAR_COMBO_EI10>
        <sql>
            SELECT   CONCAT(COG_CODIGO , ' | ' , COD_DESCRIPCION) AS DESCRIPCION  FROM CODIGO_EIE10
        </sql>
    </LISTAR_COMBO_EI10>
    
    <LISTAR_COMBO_ESTADO_TRIAGE>
        <sql>
            SELECT  EST_ID AS ID,EST_DESCRIPCION AS DESCRIPCION  FROM  ESTADO_TRIAGE  WHERE EST_ID != 6;
        </sql>
    </LISTAR_COMBO_ESTADO_TRIAGE>
    
    <LISTAR_COMBO_REFERENCIA>
        <sql>
            SELECT REFERENCIA.REF_ID AS ID,CONCAT(REFERENCIA.REF_CODIGO,' | ',REFERENCIA.REF_DESCRIPCION	) AS DESCRIPCION, 
            SUM(INVENTARIO.CANTIDAD)AS CANTIDAD, REF_DESCRIPCION AS NOMBRE FROM REFERENCIA 
            INNER JOIN INVENTARIO ON INVENTARIO.REF_ID = REFERENCIA.REF_ID 
            WHERE INVENTARIO.CANTIDAD > 0 AND REF_ESTADO ='A' GROUP BY INVENTARIO.REF_ID ORDER BY REFERENCIA.REF_ID ASC ;
        </sql>
    </LISTAR_COMBO_REFERENCIA>
    
    <LISTAR_COMBO_TIPO_PLACA>
        <sql>
            SELECT TPL_ID AS ID, TPL_DESCRIPCION AS DESCRIPCION  FROM  TIPO_PLACA;
        </sql>
    </LISTAR_COMBO_TIPO_PLACA>
    <LISTAR_COMBO_TIPO_CASO>
        <sql>
            SELECT    TCS_ID AS ID, TCS_DESCRIPCION AS DESCRIPCION  FROM  TIPO_CASO WHERE TIPO_CASO.TPC_ESTADO ='A';
        </sql>
    </LISTAR_COMBO_TIPO_CASO>
                    
    <LISTAR_COMBO_PATOLOGIA>
        <sql>
            SELECT    PAT_ID , PAT_DESCRIPCION   FROM PATOLOGIA;
        </sql>
    </LISTAR_COMBO_PATOLOGIA>
    <LISTAR_COMBO_SALIDA>
        <sql>
            SELECT  SAL_ID , SAL_NOMBRE  FROM SALIDA WHERE SAL_ESTADO = 'A';
        </sql>
    </LISTAR_COMBO_SALIDA>
    
    
    <OBTENER_MENU_USUARIO>
        <sql>
            SELECT  
            PERFIL_MENU.MEN_PADRE AS MENU_ID, 
            MENU.MEN_NOMBRE AS PAGINA_MENU,
            MEN_ICONO AS ICONO_MENU  FROM MENU MENU 
            INNER JOIN PERFIL_MENU PERFIL_MENU  
            ON  MENU.MEN_ID   =  PERFIL_MENU.MEN_PADRE
            INNER JOIN  USUARIO USU ON PERFIL_MENU.PER_ID =  USU.PER_ID
            WHERE USU_ID = ?
            AND PERFIL_MENU.PER_ID = ?
            AND  PERFIL_MENU.PRM_ESTADO =  'A' AND MENU.TIP_MENU =  1     ORDER BY MENU.MEN_ORDER ASC
        </sql>
    </OBTENER_MENU_USUARIO>
    
    
    <LISTAR_FUNCION_INTERVENTOR>
        <sql>
            SELECT    FUN_ID, FUN_DESCRIPCION  FROM FUNCIONES WHERE FUN_ESTADO = 'A';
        </sql>
    </LISTAR_FUNCION_INTERVENTOR>
    <VERIFICAR_USUARIO>
        <sql>
            SELECT  USU_USUARIO AS  USUARIO  FROM  USUARIO WHERE USU_USUARIO = ? AND USU_CONTRASENA = ?;

        </sql>
    </VERIFICAR_USUARIO>
    <ACTUALIZAR_CONTRASENA>
        <sql>
            UPDATE CONFIGURACIONES.USUARIO SET USU_CONTRASENA =? WHERE USU_USUARIO = ?;
        </sql>
    </ACTUALIZAR_CONTRASENA>
    <OPTENER_VALOR_REFERENCIA>
        <sql>
            SELECT REFERENCIA.REF_PRECIO_VENTA AS VALOR FROM REFERENCIA WHERE REFERENCIA.REF_CODIGO = ?;
        </sql>
    </OPTENER_VALOR_REFERENCIA>
    <VALOR_RECETAS>
        <sql>
            select * from referencia where ref_codigo = ? AND ref_estado = ?;
        </sql>
    </VALOR_RECETAS>
    <LISTAR_COMBO_TIPO_CLIENTE>
        <sql>
            SELECT TPC_ID , TPC_DESCRIPCION  FROM  TIPO_CLIENTE;
        </sql>
    </LISTAR_COMBO_TIPO_CLIENTE>
    <LISTAR_LOTES>
        <sql>
            SELECT  DISTINCT LT_ID AS ID, LT_DESCRIPCION  AS DESCRIPCION
            FROM INVENTARIO INNER JOIN LOTE USING(LT_ID) WHERE LT_ESTADO  = 'A' AND BOD_ID = ?
        </sql>
    </LISTAR_LOTES>
    <LISTAR_BODEGAS>
        <sql>
            SELECT BOD_ID AS ID , BOD_DESCRIPCION AS DESCRIPCION  FROM BODEGA WHERE BOD_ESTADO  ='A';
        </sql>
    </LISTAR_BODEGAS>
    
    <OPERACIOENS_USUARIO>
        <sql>
            SELECT OPE_NUMERO  FROM  OPERACIONES
            INNER JOIN USUARIO_OPERACIONES  USING(OPE_ID) WHERE  USUARIO_OPERACIONES.USU_ID =?
            AND OPE_ESTADO ='A' AND URS_ESTADO = 'A';
        </sql>
    </OPERACIOENS_USUARIO>
    <LISTAR_EMPRESAS>
        <sql>
            SELECT  REPLACE(EMP_RAZON_SOCIAL,'s.a.s','') as EMPRESA, cod_empresa as CODIGO 
            FROM EMPRESA WHERE EMP_ESTADO = 'A';
        </sql>
    </LISTAR_EMPRESAS>
    <LISTAR_COMBO_TIPO_AREA_RURAL>
        <sql>
            SELECT  AR_CODIGO AS ID, AR_DESCRIPCION AS DESCRIPCION  FROM AREA_RURAL WHERE AR_ESTADO = 'A'; 
        </sql>
    </LISTAR_COMBO_TIPO_AREA_RURAL>
    <LISTAR_COMBO_TIPO_VEHICULO>
        <sql>
            SELECT TIPVE_ID AS ID,TIPVE_DESCRIPCION AS DESCRIPCION FROM TIPO_VEHICULO WHERE TIPO_VEHICULO.TIPVE_ESTADO = 'A';
        </sql>
    </LISTAR_COMBO_TIPO_VEHICULO>
    <LISTAR_COMBO_ESTADO_VEHICULO>
        <sql>
            SELECT ESTVE_ID AS ID, ESTVE_DESCRIPCION AS DESCRIPCION FROM ESTADO_VEHICULO WHERE ESTVE_ESTADO ='A';
        </sql>
    </LISTAR_COMBO_ESTADO_VEHICULO>
    <LISTAR_LOTES_GENERAL>
        <sql>
            SELECT LT_ID AS ID , LT_DESCRIPCION AS DESCRIPCION  FROM LOTE WHERE LT_ESTADO  ='A';
        </sql>
    </LISTAR_LOTES_GENERAL>
    <LISTAR_REFERENCIAS_VENCIDAS>
        <sql>
            SELECT DATEDIFF(REF_FECHA_VENCIMIENTO,CURDATE()) AS CANTIDAD,REF_ID AS ID,
            REF_FECHA_VENCIMIENTO AS VENCIMIENTO, REF_DESCRIPCION AS DESCRIPCION,
            REF_CODIGO AS CODIGO 
            FROM REFERENCIA 
            WHERE DATEDIFF(REF_FECHA_VENCIMIENTO,CURDATE()) &lt;= 10 AND  REF_ESTADO ='A';
        </sql>
    </LISTAR_REFERENCIAS_VENCIDAS>
    <LISTAR_PEDIDOS_VENCIDOS>
        <sql>
            SELECT DATEDIFF(PED_FECHA,CURDATE()) AS CANTIDAD,PED_ID AS ID,
            PED_TOTAL AS TOTAL
            FROM PEDIDO 
            WHERE DATEDIFF(PED_FECHA,CURDATE()) >= 15 AND  PED_ESTADO ='A';
        </sql>
    </LISTAR_PEDIDOS_VENCIDOS>
    <ACTUALIZAR_PEDIDOS>
    <sql>
        UPDATE PEDIDO SET PED_ESTADO ='F' WHERE PED_ID = ?;
    </sql>
    </ACTUALIZAR_PEDIDOS>
    <LISTAR_COMBO_REFERENCIA_MODULOS>
        <sql>
            SELECT REFERENCIA.REF_ID AS ID,CONCAT(REFERENCIA.REF_CODIGO,' | ',REFERENCIA.REF_DESCRIPCION	) AS DESCRIPCION, 
            SUM(INVENTARIO.CANTIDAD)AS CANTIDAD, REF_DESCRIPCION AS NOMBRE FROM REFERENCIA 
            INNER JOIN INVENTARIO ON INVENTARIO.REF_ID = REFERENCIA.REF_ID 
            INNER JOIN TIPO_REFERENCIA USING(TPR_ID)
            WHERE INVENTARIO.CANTIDAD > 0  AND TPR_ID = ? GROUP BY INVENTARIO.REF_ID ORDER BY REFERENCIA.REF_ID ASC ;
        </sql>
    </LISTAR_COMBO_REFERENCIA_MODULOS>
    <COMBO_TIPO_ANEXOS>
        <sql>
            SELECT TANX_ID AS ID, TANX_NOMBRE AS DESCRIPCION FROM TIPO_ANEXO WHERE TANX_ESTADO ='A';
        </sql>
    </COMBO_TIPO_ANEXOS>
    <LISTAR_LABORATORIOS>
        <sql>
            SELECT LAB_ID AS ID , LAB_DESCRIPCION AS DESCRIPCION  FROM LABORATORIOS WHERE LAB_ESTADO  ='A';
        </sql>
    </LISTAR_LABORATORIOS>
    <LISTAR_INSULINAS>
        <sql>
            SELECT TIPINS_ID AS ID , TIPINS_DESCRIPCION AS DESCRIPCION  FROM TIPO_INSULINA WHERE TIPINS_ESTADO  ='A';
        </sql>
    </LISTAR_INSULINAS>
    <CONSULTAR_CODIGO_EIE10>
        <sql>
            SELECT CONCAT(COG_CODIGO , ' | ' , COD_DESCRIPCION) DESCRIPCION
            FROM clinicasv.codigo_eie10  WHERE COD_DESCRIPCION REGEXP ? OR codigo_eie10.cog_codigo REGEXP ?;
        </sql>
    </CONSULTAR_CODIGO_EIE10>
    <LISTAR_PARTE_CUERPO>
        <sql>
            SELECT PAR_ID AS ID , PAR_NOMBRE AS NOMBRE FROM PARTES_CUERPO WHERE PAR_ESTADO = 'A';
        </sql>
    </LISTAR_PARTE_CUERPO>
    <LISTAR_CAUSAS>
        <sql>
            SELECT CAU_ID AS ID, CAU_NOMBRE AS NOMBRE, CAU_CODIGO AS CODIGO 
            FROM CAUSAS WHERE  CAU_ESTADO = 'A';
        </sql>
    </LISTAR_CAUSAS>
    <LISTAR_ORDENES_VENCIDAS>
        <sql>
         SELECT  CONCAT(PAC.TER_DOCUMENTO,' ',NOMBRETERCERO(PAC.TER_DOCUMENTO)) AS  PACIENTE,
            ORD.ORD_NUMERO_ORDEN  AS ID_ORDEN, EVE_NUMERO AS EVENTO, TIPO_CLIENTE.TPC_DESCRIPCION AS TIPO, CLI.CLI_RAZON_SOCIAL AS CLIENTE,
            PAC.TER_FECHA_NACIMIENTO AS FECHA_NACIMIENTO,SEX_DESCRIPCION AS SEXO,ORD.DEP_ID AS ID_DEP,
            CONVERT(DATE_FORMAT(LOCALTIME,'%Y'),INT)-CONVERT(DATE_FORMAT(PAC.TER_FECHA_NACIMIENTO,'%Y'),INT) AS EDAD,
            CONCAT(MEDICO.TER_DOCUMENTO,' ', NOMBRETERCERO(MEDICO.TER_DOCUMENTO)) AS  MEDICO,COALESCE(ORD_DESCRIPCION ,'')AS DESCRIPCION,
            ORD.FIN_ID AS FINAL_ID,ORD.AMB_ID AS AMBIT_ID,ORD.ORD_LECTURA AS AUTORIZACION,ORD.ORD_DIAGNOSTICO AS DIAGNOSTICO,ORD.AUT_ID AS LAB_ID,
            DATE_FORMAT(ORD.ORD_FECHA,'%Y-%m-%dT%H:%i')AS FECHACREACION,
            ORD.ORD_FECHA AS FECHA
            FROM EVENTO_ORDENES  ORD
            INNER JOIN EVENTO EVE USING(EVE_ID)
            INNER JOIN  CONVENIOS CON USING (COV_ID)
            INNER JOIN  TIPO_CLIENTE USING(TPC_ID)
            INNER JOIN  CLIENTES CLI ON CLI.TER_ID =  CON.TER_ID
            INNER JOIN TERCEROS MEDICO ON MEDICO.TER_ID = ORD.TER_ID
            INNER JOIN TERCEROS  PAC  ON PAC.TER_ID =  EVE.TER_ID 
            INNER  JOIN SEXO SEX ON SEX.SEX_ID = PAC.SEX_ID
            INNER JOIN FINALIDAD FIN ON FIN.FIN_ID = ORD.FIN_ID
            INNER JOIN AMBITO AMB ON AMB.AMB_ID = ORD.AMB_ID
            WHERE ORD_ESTADO = 'A' AND ORD_ID = 65 AND EVE.EVE_ESTADO = 'A' ORDER BY ORD.EVD_ID DESC;
        </sql>
    </LISTAR_ORDENES_VENCIDAS>
    <LISTAR_CONTRATOS_VENCER>
        <sql>
            SELECT
            CT.CTRA_ID AS ID_CONTRATO,
            CT.CTRA_NUMERO AS NUMERO_CONTRATO,
            CONCAT( EMPL.EMPL_PRIMER_APELLIDO, ' ', EMPL.EMPL_SEGUNDO_APELLIDO, ' ', EMPL.EMPL_PRIMER_NOMBRE, ' ', EMPL.EMPLE_SEGUNDO_NOMBRE ) AS EMPLEADO,
            CRG.CRG_DESCRIPCION AS CARGO,
            DATE( CT.CTRA_FECHA_INICIO ) AS FECHA_INICIO,
            CURDATE() AS FECHA_ACTUAL,
            DATE( CT.CTRA_FECHA_FINAL ) AS FECHA_CULMINACION,
            DATEDIFF(
            DATE( CT.CTRA_FECHA_FINAL ),
            DATE(
            CURDATE())) AS DIAS_RESTANTES 
            FROM
            CONTRATO CT
            INNER JOIN EMPLEADOS EMPL ON EMPL.EMPL_ID = CT.EMPL_ID
            INNER JOIN CARGOS CRG ON CRG.CRG_ID = CT.CRG_ID 
            WHERE
            DATEDIFF(DATE( CT.CTRA_FECHA_FINAL ),DATE(CURDATE())) &lt;=  40
        </sql>
    </LISTAR_CONTRATOS_VENCER>
    <DOCUMENTOS_VENCIDOS>
        <sql>
            SELECT
            ANX_ID AS ID,
            DATE(ANX_FECHA_CADUCIDAD) AS FECHA_CADUCIDAD,
            DATEDIFF(DATE(ANX_FECHA_CADUCIDAD),DATE(CURDATE())) AS DIAS,
            ANX_DESCRIPCION AS DESCRIPCION
            FROM
            ANEXOS 
            WHERE DATEDIFF(ANX_FECHA_CADUCIDAD,CURDATE()) &lt;=30 AND ANX_ESTADO = 'A';
        </sql>
    </DOCUMENTOS_VENCIDOS>
</root>
